<section class="home-container">
  <h2>ðŸ›’ CatÃ¡logo de productos</h2>

  <form method="get" action="/products" class="filters">
    <label>
      CategorÃ­a / query:
      <input type="text" name="query" value="{{query}}">
    </label>
    <label>
      Orden:
      <select name="sort">
        <option value="" {{#unless sort}}selected{{/unless}}>Sin orden</option>
        <option value="asc" {{#if (eq sort "asc")}}selected{{/if}}>Precio asc</option>
        <option value="desc" {{#if (eq sort "desc")}}selected{{/if}}>Precio desc</option>
      </select>
    </label>
    <label>
      Por pÃ¡gina:
      <input type="number" name="limit" value="10" min="1">
    </label>
    <button type="submit">Aplicar</button>
  </form>

  {{#if products.length}}
    <div class="product-grid">
      {{#each products}}
        <div class="product-card">
          <h3>{{this.title}}</h3>
          <p class="desc">{{this.description}}</p>
          <p><strong>Precio:</strong> ${{this.price}}</p>
          <p><strong>Stock:</strong> {{this.stock}}</p>
          <p><strong>CategorÃ­a:</strong> {{this.category}}</p>

          <a href="/products/{{this._id}}">Ver detalle</a>

          <form method="post" action="/api/carts/{{../cartId}}/product/{{this._id}}">
            <input type="hidden" name="quantity" value="1" />
            <button type="submit">Agregar al carrito</button>
          </form>
        </div>
      {{/each}}
    </div>

    <nav class="pagination">
      {{#if hasPrevPage}}
        <a href="{{prevLink}}">â¬… PÃ¡gina anterior</a>
      {{/if}}

      <span>PÃ¡gina {{page}} de {{totalPages}}</span>

      {{#if hasNextPage}}
        <a href="{{nextLink}}">PÃ¡gina siguiente âž¡</a>
      {{/if}}
    </nav>
  {{else}}
    <p class="empty">No hay productos aÃºn ðŸ˜”</p>
  {{/if}}

  <p>
    <a href="/mycart">Ver mi carrito</a>
  </p>
</section>
